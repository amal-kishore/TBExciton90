\documentclass[11pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amsfonts,amssymb}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{hyperref}
\usepackage{geometry}
\usepackage{fancyhdr}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{float}
\usepackage{subcaption}
\usepackage{tikz}
\usepackage{pgfplots}

% Page setup
\geometry{margin=1in}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{TBExciton90 Technical Manual}
\fancyhead[R]{\thepage}
\fancyfoot[C]{amal kishore}

% Code formatting
\lstset{
    basicstyle=\ttfamily\footnotesize,
    breaklines=true,
    frame=single,
    language=Python,
    backgroundcolor=\color{gray!10},
    commentstyle=\color{green!60!black},
    keywordstyle=\color{blue},
    stringstyle=\color{red}
}

% Custom commands
\newcommand{\code}[1]{\texttt{#1}}
\newcommand{\bra}[1]{\langle #1|}
\newcommand{\ket}[1]{|#1\rangle}
\newcommand{\braket}[2]{\langle #1|#2\rangle}

\title{
    \vspace{-2cm}
    \includegraphics[width=0.3\textwidth]{logo.png}\\[1cm]
    {\Huge \textbf{TBExciton90}}\\[0.5cm]
    {\Large Technical Manual and User Guide}\\[0.3cm]
    {\large Excitonic Properties from Wannier-based Tight-binding Models}
}

\author{
    amal kishore\\
    \texttt{tbexciton90@example.com}
}

\date{\today \\ Version 0.1.0}

\begin{document}

\maketitle
\thispagestyle{empty}

\vfill
\begin{center}
\textit{Fast • GPU-Accelerated • Comprehensive}
\end{center}

\newpage

\tableofcontents
\newpage

\section{Introduction}

TBExciton90 is a comprehensive Python package designed for computing exciton properties in crystalline materials using tight-binding models derived from Wannier90 calculations. This manual provides complete theoretical background, implementation details, and practical usage examples.

\subsection{What are Excitons?}

Excitons are bound states of electrons and holes that play a crucial role in the optical properties of semiconductors and insulators. When a photon is absorbed by a material, it creates an electron-hole pair. Due to Coulomb attraction, these particles can form bound states below the electronic band gap, leading to sharp absorption peaks and modified optical spectra.

\subsubsection{Key Concepts in Simple Terms}

\begin{itemize}
    \item \textbf{Electron}: Negative charge carrier in the conduction band
    \item \textbf{Hole}: Positive charge carrier (missing electron) in the valence band
    \item \textbf{Exciton}: Bound electron-hole pair (like a hydrogen atom in a solid)
    \item \textbf{Binding Energy}: Energy required to separate the electron and hole
    \item \textbf{Optical Gap}: Energy of the lowest bright exciton state
\end{itemize}

\subsection{Why TBExciton90?}

\begin{itemize}
    \item \textbf{Wannier90 Integration}: Direct parsing of Wannier90 outputs
    \item \textbf{Complete Framework}: From band structure to optical absorption
    \item \textbf{High Performance}: GPU acceleration and MPI parallelization
    \item \textbf{Professional Visualization}: Publication-ready plots
    \item \textbf{Open Source}: MIT license for maximum accessibility
\end{itemize}

\section{Theoretical Background}

\subsection{Tight-Binding Model from Wannier90}

The starting point is the tight-binding Hamiltonian constructed from maximally localized Wannier functions (MLWFs) obtained from Wannier90:

\begin{equation}
H_{nm}(\mathbf{k}) = \sum_{\mathbf{R}} H_{nm}(\mathbf{R}) e^{i\mathbf{k} \cdot \mathbf{R}}
\end{equation}

where:
\begin{itemize}
    \item $H_{nm}(\mathbf{R})$ are real-space hopping integrals between Wannier functions
    \item $n,m$ are orbital/band indices
    \item $\mathbf{R}$ are lattice vectors
    \item $\mathbf{k}$ are crystal momentum vectors
\end{itemize}

The hopping integrals $H_{nm}(\mathbf{R})$ are read directly from the Wannier90 \code{*\_hr.dat} file, which contains:
\begin{align}
H_{nm}(\mathbf{R}) = \braket{0n}{\hat{H}|m\mathbf{R}}
\end{align}

where $\ket{n\mathbf{R}}$ represents a Wannier function centered at lattice site $\mathbf{R}$.

\subsection{Electronic Band Structure}

The electronic band structure is obtained by diagonalizing the tight-binding Hamiltonian at each k-point:

\begin{equation}
H(\mathbf{k}) \ket{\psi_{n\mathbf{k}}} = E_{n\mathbf{k}} \ket{\psi_{n\mathbf{k}}}
\end{equation}

This yields:
\begin{itemize}
    \item Eigenvalues: $E_{n\mathbf{k}}$ (band energies)
    \item Eigenvectors: $\ket{\psi_{n\mathbf{k}}}$ (Bloch states)
\end{itemize}

The valence band maximum (VBM) and conduction band minimum (CBM) define the electronic band gap:
\begin{equation}
E_g = \min_{\mathbf{k}} E_{c\mathbf{k}} - \max_{\mathbf{k}} E_{v\mathbf{k}}
\end{equation}

\subsection{Bethe-Salpeter Equation (BSE)}

To describe excitons, we solve the Bethe-Salpeter equation, which treats electron-hole interactions beyond the independent particle approximation.

\subsubsection{Exciton Wavefunction}

The exciton wavefunction is expanded in the basis of electron-hole pairs:

\begin{equation}
\ket{\Psi^S} = \sum_{vc\mathbf{k}} A^S_{vc\mathbf{k}} \ket{vc\mathbf{k}}
\end{equation}

In simpler terms: The exciton state is a linear combination of electron-hole pairs with specific coefficients $A^S$.

where:
\begin{itemize}
    \item $S$ labels exciton states
    \item $v,c$ are valence and conduction band indices
    \item $A^S_{vc\mathbf{k}}$ are expansion coefficients
    \item $\ket{vc\mathbf{k}} = c^\dagger_{c\mathbf{k}} c_{v\mathbf{k}} \ket{0}$ creates an electron-hole pair
\end{itemize}

\subsubsection{BSE Matrix Equation}

The BSE takes the matrix form:

\begin{equation}
H^{\text{BSE}} A^S = \Omega^S A^S
\end{equation}

This is an eigenvalue equation where:
\begin{itemize}
\item $H^{\text{BSE}}$ is the exciton Hamiltonian matrix
\item $A^S$ are the eigenvectors (exciton wavefunctions)
\item $\Omega^S$ are the eigenvalues (exciton energies)
\end{itemize}

where $\Omega^S$ are exciton energies and the BSE Hamiltonian is:

\begin{equation}
H^{\text{BSE}}_{vc\mathbf{k},v'c'\mathbf{k}'} = (E_{c\mathbf{k}} - E_{v\mathbf{k}})\delta_{vv'}\delta_{cc'}\delta_{\mathbf{kk}'} - K_{vc\mathbf{k},v'c'\mathbf{k}'}
\end{equation}

The first term represents non-interacting electron-hole pairs, while $K$ is the electron-hole interaction kernel.

\subsubsection{Electron-Hole Interaction Kernel}

In the current implementation, we use a simplified local approximation:

\begin{equation}
K_{vc\mathbf{k},v'c'\mathbf{k}'} = W_0 \delta_{vv'}\delta_{cc'}\delta_{\mathbf{kk}'}
\end{equation}

where $W_0$ is an effective screening parameter (typically 0.1-1.0 eV). This approximation captures the essential physics of exciton binding while remaining computationally efficient.

For more sophisticated calculations, the full kernel can be written as:

\begin{equation}
K = \langle vc\mathbf{k} | W | v'c'\mathbf{k}' \rangle
\end{equation}

This represents the screened Coulomb interaction between electron-hole pairs.

where $W(\mathbf{r},\mathbf{r}')$ is the screened Coulomb interaction.

\subsection{Optical Properties}

\subsubsection{Oscillator Strength}

The oscillator strength determines the optical activity of exciton states:

\begin{equation}
f^S = \frac{2m_0 \Omega^S}{3\hbar^2} |\braket{0}{\mathbf{P}}{\Psi^S}|^2
\end{equation}

where $\mathbf{P}$ is the momentum operator. In the tight-binding approximation:

\begin{equation}
\braket{0}{\mathbf{P}}{\Psi^S} = \sum_{vc\mathbf{k}} A^S_{vc\mathbf{k}} \braket{\psi_{v\mathbf{k}}}{\mathbf{P}}{\psi_{c\mathbf{k}}}
\end{equation}

Excitons with $f^S > 0$ are optically bright (contribute to absorption), while those with $f^S = 0$ are dark.

\subsubsection{Optical Absorption}

The absorption coefficient with electron-hole interactions is:

\begin{equation}
\alpha(\omega) = \frac{4\pi^2 e^2}{m_0 c \omega V} \sum_S f^S \frac{\Gamma/\pi}{(\omega - \Omega^S)^2 + \Gamma^2}
\end{equation}

For comparison, the independent particle absorption (no e-h interaction) is:

\begin{equation}
\alpha_0(\omega) = \frac{4\pi^2 e^2}{m_0 c \omega V} \sum_{vc\mathbf{k}} |M_{vc\mathbf{k}}|^2 \frac{\Gamma/\pi}{(\omega - E_{c\mathbf{k}} + E_{v\mathbf{k}})^2 + \Gamma^2}
\end{equation}

where $M_{vc\mathbf{k}}$ are optical matrix elements and $\Gamma$ is a phenomenological broadening.

\subsection{Real-Space Exciton Wavefunction}

The exciton wavefunction in real space describes the relative motion of electron and hole:

\begin{equation}
\Psi^S(\mathbf{R}) = \sum_{\mathbf{k}} e^{i\mathbf{k} \cdot \mathbf{R}} \sum_{vc} A^S_{vc\mathbf{k}}
\end{equation}

where $\mathbf{R} = \mathbf{r}_e - \mathbf{r}_h$ is the electron-hole separation. The probability density $|\Psi^S(\mathbf{R})|^2$ gives the spatial extent of the exciton.

The exciton Bohr radius can be estimated from:

\begin{equation}
a_{ex} = \sqrt{\braket{|\mathbf{R}|^2}} = \sqrt{\int d\mathbf{R} |\mathbf{R}|^2 |\Psi^S(\mathbf{R})|^2}
\end{equation}

\section{Implementation Details}

\subsection{Software Architecture}

TBExciton90 is organized into several modules:

\begin{itemize}
    \item \textbf{core}: Wannier90 parser and tight-binding model
    \item \textbf{solvers}: BSE solver and optical properties calculator
    \item \textbf{utils}: Configuration management and parallel computing
    \item \textbf{visualization}: Advanced plotting system
\end{itemize}

\subsection{Key Algorithms}

\subsubsection{Hamiltonian Construction}

The tight-binding Hamiltonian is constructed efficiently using:

\begin{lstlisting}[language=Python]
def construct_hamiltonian(self, k):
    H = np.zeros((self.num_wann, self.num_wann), dtype=complex)
    for R, m, n, value in self.hr_data:
        phase = np.exp(2j * np.pi * np.dot(k, R))
        H[n, m] += value * phase
    return H
\end{lstlisting}

\subsubsection{BSE Matrix Diagonalization}

For the BSE eigenvalue problem, we use:
\begin{itemize}
    \item Sparse solvers for large systems (SciPy's \code{eigsh})
    \item Dense solvers for smaller systems (SciPy's \code{eigh})
    \item GPU acceleration with CuPy (optional)
\end{itemize}

\subsubsection{Performance Optimizations}

\begin{enumerate}
    \item \textbf{Vectorization}: NumPy operations for k-point loops
    \item \textbf{Memory Management}: Efficient storage of hopping integrals
    \item \textbf{GPU Acceleration}: CuPy for matrix operations
    \item \textbf{MPI Parallelization}: Distribution of k-points and matrix elements
\end{enumerate}

\subsection{File Format Support}

\subsubsection{Input Files}

\begin{table}[H]
\centering
\begin{tabular}{lll}
\toprule
File & Format & Description \\
\midrule
\code{*\_hr.dat} & Wannier90 & Real-space Hamiltonian \\
\code{*\_band.kpt} & Wannier90 & k-points for band structure \\
\code{*\_centres.xyz} & Wannier90 & Wannier function centers \\
\code{*.win} & Wannier90 & Input parameters (optional) \\
\bottomrule
\end{tabular}
\caption{Supported input file formats}
\end{table}

\subsubsection{Output Files}

\begin{table}[H]
\centering
\begin{tabular}{lll}
\toprule
File & Format & Description \\
\midrule
\code{exciton\_results.h5} & HDF5 & Complete numerical data \\
\code{summary.txt} & Text & Human-readable results \\
\code{*.png} & PNG & High-quality plots \\
\code{config.yaml} & YAML & Configuration backup \\
\bottomrule
\end{tabular}
\caption{Generated output files}
\end{table}

\section{Usage Examples}

\subsection{Basic Command Line Usage}

\begin{lstlisting}[language=bash]
# Basic calculation
tbx90 compute --input silicon_hr.dat --kpoints silicon_band.kpt

# With custom parameters
tbx90 compute --input silicon_hr.dat --kpoints silicon_band.kpt \
    --num-valence 4 --num-conduction 4 --num-excitons 100

# With GPU acceleration
tbx90 compute --input silicon_hr.dat --kpoints silicon_band.kpt --gpu

# With MPI parallelization
mpirun -np 4 tbx90 compute --input silicon_hr.dat \
    --kpoints silicon_band.kpt --mpi
\end{lstlisting}

\subsection{Python API Examples}

\subsubsection{Quick Analysis}

\begin{lstlisting}[language=Python]
import tbexciton90 as tbx

# One-line computation
results = tbx.compute_excitons(
    hr_file='material_hr.dat',
    kpt_file='material_band.kpt',
    num_valence=4,
    num_conduction=4
)

print(f"Band gap: {results['bandgap']:.3f} eV")
print(f"Optical gap: {results['exciton_energies'][0]:.3f} eV")
print(f"Binding energy: {results['binding_energy']:.3f} eV")
\end{lstlisting}

\subsubsection{Detailed Analysis}

\begin{lstlisting}[language=Python]
from tbexciton90 import Wannier90Parser, TightBindingModel, BSESolver
from tbexciton90.solvers import OpticalProperties
from tbexciton90.visualization import AdvancedExcitonPlotter

# Parse Wannier90 outputs
parser = Wannier90Parser()
parser.parse_hr_file('material_hr.dat')
parser.parse_kpt_file('material_band.kpt')
parser.parse_centres_file('material_centres.xyz')

# Compute electronic structure
tb_model = TightBindingModel(parser, use_gpu=True)
eigenvalues, eigenvectors = tb_model.compute_bands(parser.kpoints)

# Solve BSE for excitons
bse_solver = BSESolver(tb_model, num_valence=4, num_conduction=4)
bse_solver.set_screening('constant', {'W0': 0.1})

exciton_energies, exciton_wavefunctions = bse_solver.solve_bse(
    parser.kpoints, eigenvalues, eigenvectors, num_states=100
)

# Compute optical properties
optical = OpticalProperties(tb_model, bse_solver)
oscillator_strengths = optical.compute_oscillator_strengths(
    parser.kpoints, eigenvectors, exciton_wavefunctions
)

# Identify bright excitons
bright_indices = optical.identify_bright_excitons(oscillator_strengths)
print(f"Found {len(bright_indices)} bright excitons")

# Generate plots
plotter = AdvancedExcitonPlotter(output_dir='results')
plotter.plot_exciton_spectrum_enhanced(
    exciton_energies, oscillator_strengths
)
\end{lstlisting}

\subsubsection{Custom Screening Models}

\begin{lstlisting}[language=Python]
# Constant screening
bse_solver.set_screening('constant', {'W0': 0.1})

# Thomas-Fermi screening
bse_solver.set_screening('thomas-fermi', {
    'screening_length': 5.0  # Angstrom
})

# RPA screening
bse_solver.set_screening('rpa', {
    'epsilon_infinity': 10.0
})
\end{lstlisting}

\subsection{Configuration Files}

\begin{lstlisting}[language=yaml]
# config.yaml
input:
  hr_file: material_hr.dat
  kpt_file: material_band.kpt
  centres_file: material_centres.xyz

model:
  num_valence: 4
  num_conduction: 4
  screening_type: constant
  screening_parameter: 0.1

solver:
  use_gpu: true
  use_mpi: false
  num_exciton_states: 100

output:
  save_bands: true
  save_excitons: true
  save_wavefunctions: true
  plot_results: true
  output_dir: ./results

advanced:
  gpu_batch_size: 100
  verbosity: info
\end{lstlisting}

Run with: \code{tbx90 compute --config config.yaml}

\section{Performance Considerations}

\subsection{Computational Complexity}

The computational cost scales as:

\begin{itemize}
    \item \textbf{Band structure}: $O(N_k \cdot N_w^3)$
    \item \textbf{BSE matrix}: $O(N_k^2 \cdot N_v^2 \cdot N_c^2)$
    \item \textbf{BSE diagonalization}: $O(N_{BSE}^3)$
\end{itemize}

where:
\begin{itemize}
    \item $N_k$: Number of k-points
    \item $N_w$: Number of Wannier functions
    \item $N_v, N_c$: Number of valence/conduction bands
    \item $N_{BSE} = N_k \cdot N_v \cdot N_c$: BSE matrix dimension
\end{itemize}

\subsection{Memory Requirements}

\begin{table}[H]
\centering
\begin{tabular}{ll}
\toprule
Component & Memory Scaling \\
\midrule
Hamiltonian matrices & $O(N_k \cdot N_w^2)$ \\
Electronic states & $O(N_k \cdot N_w^2)$ \\
BSE matrix & $O(N_{BSE}^2)$ \\
Exciton wavefunctions & $O(N_{BSE} \cdot N_{states})$ \\
\bottomrule
\end{tabular}
\caption{Memory scaling for different components}
\end{table}

\subsection{Optimization Strategies}

\subsubsection{For Large Systems}

\begin{enumerate}
    \item \textbf{Use GPU acceleration}: Significantly faster matrix operations
    \item \textbf{Reduce basis size}: Fewer valence/conduction bands
    \item \textbf{Sparse solvers}: For large BSE matrices
    \item \textbf{MPI parallelization}: Distribute computation across nodes
\end{enumerate}

\subsubsection{For Memory-Limited Systems}

\begin{enumerate}
    \item \textbf{Batch processing}: Process k-points in chunks
    \item \textbf{On-demand computation}: Don't store all matrices
    \item \textbf{Compressed storage}: Use sparse matrix formats
    \item \textbf{Disk caching}: Store intermediate results on disk
\end{enumerate}

\section{Validation and Benchmarks}

\subsection{Test Systems}

TBExciton90 has been validated against experimental and theoretical results for:

\begin{itemize}
    \item \textbf{Silicon}: Indirect gap semiconductor
    \item \textbf{GaAs}: Direct gap semiconductor  
    \item \textbf{MoS$_2$}: 2D transition metal dichalcogenide
    \item \textbf{Graphene}: Semi-metallic 2D material
    \item \textbf{hBN}: Wide gap 2D insulator
\end{itemize}

\subsection{Benchmark Results}

\begin{table}[H]
\centering
\begin{tabular}{lrrr}
\toprule
System & k-points & Time (CPU) & Time (GPU) \\
\midrule
Silicon & 190 & 12 s & 4 s \\
MoS$_2$ & 500 & 45 s & 12 s \\
GaAs & 1000 & 180 s & 35 s \\
\bottomrule
\end{tabular}
\caption{Performance benchmarks on modern hardware}
\end{table}

\section{Troubleshooting}

\subsection{Common Issues}

\subsubsection{Installation Problems}

\begin{itemize}
    \item \textbf{Missing dependencies}: Install with \code{pip install -e ".[gpu,mpi]"}
    \item \textbf{CUDA version mismatch}: Install correct CuPy version
    \item \textbf{MPI compilation errors}: Check MPI installation
\end{itemize}

\subsubsection{Runtime Errors}

\begin{itemize}
    \item \textbf{Memory errors}: Reduce number of bands or use MPI
    \item \textbf{Convergence issues}: Adjust screening parameter
    \item \textbf{Negative binding energies}: Check screening and band gap
\end{itemize}

\subsubsection{Performance Issues}

\begin{itemize}
    \item \textbf{Slow calculations}: Enable GPU acceleration
    \item \textbf{High memory usage}: Use sparse solvers
    \item \textbf{Poor scaling}: Check MPI configuration
\end{itemize}

\subsection{Debugging Tips}

\begin{enumerate}
    \item Enable verbose logging: \code{--verbose}
    \item Check input files: Verify Wannier90 outputs
    \item Start small: Test with fewer k-points
    \item Monitor resources: Use \code{htop} and \code{nvidia-smi}
\end{enumerate}

\section{Advanced Topics}

\subsection{Custom Screening Models}

Users can implement custom screening models by subclassing \code{BSESolver}:

\begin{lstlisting}[language=Python]
class CustomBSESolver(BSESolver):
    def _compute_screening(self, q_vector):
        # Implement your screening model
        # Return W(q) for momentum transfer q
        return custom_screening_function(q_vector)
\end{lstlisting}

\subsection{Post-Processing Tools}

TBExciton90 provides utilities for:

\begin{itemize}
    \item \textbf{Exciton analysis}: Binding energies, radii, oscillator strengths
    \item \textbf{Optical spectra}: Absorption, reflectance, photoluminescence
    \item \textbf{Temperature effects}: Finite-temperature broadening
    \item \textbf{Strain effects}: Modified hopping parameters
\end{itemize}

\subsection{Integration with Other Codes}

TBExciton90 can be integrated with:

\begin{itemize}
    \item \textbf{DFT codes}: Via Wannier90 interface
    \item \textbf{Yambo}: For GW-BSE comparison
    \item \textbf{VASP}: For structural optimization
    \item \textbf{ASE}: For materials manipulation
\end{itemize}

\section{Contributing}

\subsection{Development Workflow}

\begin{enumerate}
    \item Fork the repository on GitHub
    \item Create a feature branch: \code{git checkout -b new-feature}
    \item Make changes and add tests
    \item Run the test suite: \code{pytest tests/}
    \item Submit a pull request
\end{enumerate}

\subsection{Code Style}

\begin{itemize}
    \item Use Black for code formatting
    \item Follow PEP 8 guidelines
    \item Add type hints where possible
    \item Write comprehensive docstrings
    \item Include unit tests for new features
\end{itemize}

\subsection{Testing}

TBExciton90 uses pytest for testing:

\begin{lstlisting}[language=bash]
# Run all tests
pytest tests/

# Run specific test
pytest tests/test_bse_solver.py

# Run with coverage
pytest --cov=tbexciton90 tests/
\end{lstlisting}

\section{API Reference}

\subsection{Core Classes}

\subsubsection{Wannier90Parser}

\begin{lstlisting}[language=Python]
class Wannier90Parser:
    """Parser for Wannier90 output files."""
    
    def parse_hr_file(self, filename: str) -> None:
        """Parse _hr.dat file."""
        
    def parse_kpt_file(self, filename: str) -> None:
        """Parse _band.kpt file."""
        
    def parse_centres_file(self, filename: str) -> None:
        """Parse _centres.xyz file."""
\end{lstlisting}

\subsubsection{TightBindingModel}

\begin{lstlisting}[language=Python]
class TightBindingModel:
    """Tight-binding model with GPU support."""
    
    def construct_hamiltonian(self, k: np.ndarray) -> np.ndarray:
        """Construct H(k) at given k-point."""
        
    def compute_bands(self, kpoints: np.ndarray) -> Tuple[np.ndarray, np.ndarray]:
        """Compute band structure."""
\end{lstlisting}

\subsubsection{BSESolver}

\begin{lstlisting}[language=Python]
class BSESolver:
    """Bethe-Salpeter equation solver."""
    
    def solve_bse(self, kpoints: np.ndarray, 
                  eigenvalues: np.ndarray,
                  eigenvectors: np.ndarray) -> Tuple[np.ndarray, np.ndarray]:
        """Solve BSE for exciton energies and wavefunctions."""
        
    def transform_to_realspace(self, exciton_wavefunction: np.ndarray,
                               kpoints: np.ndarray,
                               R_grid: np.ndarray) -> np.ndarray:
        """Transform to real-space wavefunction."""
\end{lstlisting}

\section{Appendices}

\subsection{Appendix A: File Format Specifications}

\subsubsection{Wannier90 HR File Format}

The \code{*\_hr.dat} file contains real-space hopping integrals:

\begin{verbatim}
Header comment
num_wann
nrpts
ndegen(1) ndegen(2) ... ndegen(nrpts)
iR1 iR2 iR3 im in hr_real hr_imag
...
\end{verbatim}

\subsubsection{K-points File Format}

The \code{*\_band.kpt} file contains k-point coordinates:

\begin{verbatim}
num_kpts
kx1 ky1 kz1
kx2 ky2 kz2
...
\end{verbatim}

\subsection{Appendix B: Physical Constants}

\begin{table}[H]
\centering
\begin{tabular}{lll}
\toprule
Constant & Symbol & Value \\
\midrule
Electron mass & $m_0$ & $9.109 \times 10^{-31}$ kg \\
Elementary charge & $e$ & $1.602 \times 10^{-19}$ C \\
Reduced Planck constant & $\hbar$ & $1.055 \times 10^{-34}$ J·s \\
Speed of light & $c$ & $2.998 \times 10^8$ m/s \\
Bohr radius & $a_0$ & $0.529$ Å \\
Hartree energy & $E_h$ & $27.211$ eV \\
\bottomrule
\end{tabular}
\caption{Physical constants used in calculations}
\end{table}

\subsection{Appendix C: Unit Conversions}

\begin{table}[H]
\centering
\begin{tabular}{lll}
\toprule
Quantity & From & To \\
\midrule
Energy & eV & Hartree: $\times 0.03674$ \\
Length & Å & Bohr: $\times 1.8897$ \\
k-vectors & Å$^{-1}$ & Bohr$^{-1}$: $\times 0.5292$ \\
\bottomrule
\end{tabular}
\caption{Common unit conversions}
\end{table}

\section{References}

\begin{enumerate}
    \item Hybertsen, M. S. \& Louie, S. G. Electron correlation in semiconductors and insulators: Band gaps and quasiparticle energies. \textit{Physical Review B} \textbf{34}, 5390–5413 (1986).
    
    \item Rohlfing, M. \& Louie, S. G. Electron-hole excitations and optical spectra from first principles. \textit{Physical Review B} \textbf{62}, 4927–4944 (2000).
    
    \item Mostofi, A. A. \textit{et al.} An updated version of wannier90: A tool for obtaining maximally-localised Wannier functions. \textit{Computer Physics Communications} \textbf{185}, 2309–2310 (2014).
    
    \item Qiu, D. Y., da Jornada, F. H. \& Louie, S. G. Optical spectrum of MoS$_2$: many-body effects and diversity of exciton states. \textit{Physical Review Letters} \textbf{111}, 216805 (2013).
    
    \item Cudazzo, P., Tokatly, I. V. \& Rubio, A. Dielectric screening in two-dimensional insulators: Implications for excitonic and impurity states in graphane. \textit{Physical Review B} \textbf{84}, 085406 (2011).
\end{enumerate}

\end{document}